Sub Query 

1. display all the records from customers who made a purchase of books  

select * from Customers where CustId in
(select  custId from Orders where productName ='books')


2. display all the records from customer who made a purchase of books , toys, 
cd 

select * from Customers where CustId in
(select  custId from Orders where productName like ='books' 
and productName ='toys' 
and productName = 'cd'
)



3. display the list of customers who never made any purchase 

select *
from Customers
where CustId not in(
    select distinct custId
    from Orders
);


4. display the second highest age from customers (do not use top keyword) 

select max(Age) as SecondHighestAge
from Customers
where Age < (select MAX(Age) from Customers);


5. display the list from orders  where customers stays in bangalore 

select *
from Orders
where custId in (
    select CustId
    from Customers
    where CustAddress = 'Bangalore'
);


6. display list of customer who made lowest purchase (in terms of quantity) 

select *
from Customers
where CustId in (
    select custId
    from Orders
    where quantity = (select Min(quantity) from Orders)
);


7. display the list of customer who's age is greater then  ajay's age ( but we 
dont know ajay's age) 

select *
from Customers
where Age > (
    select Age
    from Customers
    where CustName = 'Anand'
);


8. update customer table where 
custid =100's age  =     custid=200's age 


update Customers
set Age = (select Age from Customers where CustId = 200)
where CustId = 100;

select * from Customers

9. Display those details who made orders in December of any year 

select *
from Orders
where month(orderDate) = 12;


10. Show all  orders made before first half of the month (before the 16th of the 
month who does not reside in bangalore). 

select *
from Orders
where DAY(orderDate) < 16
  and custId in (
      select CustId
      from Customers
      where CustAddress = 'Bangalore'
  );


11. Display list of customers  from delhi and Bangalore who made purchase of 
less than 3 product  

select *
from Customers
where CustId in (
    select custId
    from Orders
    where quantity < 3
)
and CustAddress in ('Delhi','Bangalore');


12. Display list of orders where price is greater than average price 

select *
from Orders
where price > (select AVG(price) from Orders);


13. update orders table increasing  price by 10%  for customers residing in 
Bangalore and who have purchased books. 

update Orders
set price = price * 1.10
where custId in (
    select CustId
    from Customers
    where CustAddress = 'Bangalore'
)
and productName LIKE '%books%';



14.Display orderdetails in following format 
OrderID-Date Total(price*qty) 
100-1/1/2000 500

select 
    cast(orderId as varchar(10)) + '-' + convert(varchar(10), orderDate, 101) as [OrderID-Date],
    price * quantity as Total
from Orders;


